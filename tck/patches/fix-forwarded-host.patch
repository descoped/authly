--- a/src/authly/api/oidc_router.py
+++ b/src/authly/api/oidc_router.py
@@ -45,7 +45,10 @@ def get_base_url(request: Request) -> str:
         scheme = request.url.scheme
 
     if request.headers.get("x-forwarded-host"):
-        host = request.headers.get("x-forwarded-host")
+        # Handle multiple comma-separated values (take the first one)
+        forwarded_host = request.headers.get("x-forwarded-host")
+        # Split on comma and take the first value, strip whitespace
+        host = forwarded_host.split(",")[0].strip() if forwarded_host else request.url.netloc
     else:
         host = request.headers.get("host", request.url.netloc)
 
--- a/src/authly/api/oauth_discovery_router.py
+++ b/src/authly/api/oauth_discovery_router.py
@@ -35,7 +35,11 @@ def _build_issuer_url(request: Request) -> str:
 
     # Get host, handling the case where it might include port
     host_header = request.headers.get("x-forwarded-host", request.headers.get("host"))
-
+    
+    # Handle multiple comma-separated values in X-Forwarded-Host (take the first one)
+    if host_header and "," in host_header:
+        host_header = host_header.split(",")[0].strip()
+    
     if host_header:
         # Host header might include port (e.g., "localhost:8000")
         # Parse it to separate hostname and port